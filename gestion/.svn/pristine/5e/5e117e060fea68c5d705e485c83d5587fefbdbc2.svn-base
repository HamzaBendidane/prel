<?php
function _validation_require_once_files() {
    require_once 'validation_liste_db.inc';
    require_once 'validation_liste_submit.inc';
    require_once 'validation_liste_validate.inc';
}

/**
 *  Formulaire de recherche des établissements
 *  @author Patrick
 *  @param Aucun
 *  @return Template array
 *
 */
function dgf_administration_etablissements_listes_form($form, &$form_state) {

    _validation_require_once_files();

    $data = get_stored_date();

    $siret = isset($data['siret']) ? $data['siret'] : '';
    $corporateName = isset($data['raison_sociale']) ? $data['raison_sociale'] : '';
    $responsibleName = isset($data['nom_contact']) ? $data['nom_contact'] : '';

  $form['filtre_etablissement']['siret'] = array(
    '#type' => 'textfield',
    '#title' => t('SIRET'),
    '#default_value' => $siret,
    '#field_suffix' => '<span class="spinner">&nbsp;</span>',
    '#attributes' => array(
        'class' => array('siret-lenght')
    ),
  );
  $form['filtre_etablissement']['raison_sociale'] = array(
    '#type' => 'textfield',
    '#title' => t('Raison sociale'),
      '#default_value' => $corporateName,

  );
  $form['filtre_etablissement']['nom_contact'] = array(
    '#type' => 'textfield',
    '#title' => t('Responsable'),
      '#default_value' => $responsibleName,
  );

    $form['filtre_etablissement']['send'] = array(
        '#type' => 'submit',
        '#value' => t('RECHERCHER'),
         '#submit' => array('dgf_administration_etablissements_listes_form_submit'),
    );
    $form['filtre_etablissement']['reset'] = array(
        '#type' => 'submit',
        '#value' => t('Réinitialiser'),
        '#attributes' => array(
            'class' => array('btn')
        ),
        '#submit' => array('dgf_administration_etablissements_listes_reinit_form_submit'),
    );

  return $form;
}
/**
 *  Implements hook_theme()
 *  @author Patrick
 *  @param Aucun
 *  @return Template array
 *
 */
function validation_liste_theme() {
  $theme = array(
        'validation_liste' => array(
            'template' => 'validation_liste',
        ),
    );
  return $theme;
}

 /**
 *  @author Patrick M.
 *  @param Aucun
 *  @return Template.
 *
 */
 function validation_liste_view() {
  $variables =  array(
    'validation_liste'=> drupal_get_form('validation_liste_form')
  );

  $output = theme('validation_liste', $variables);

  return $output;
}
