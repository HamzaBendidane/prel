<?php
    /* Médiathèque rows results */

    /* Get classes depending on user permissions */
    $publicElementClass = $element->publicElementClass;
    
    $urlToMedia = url(
        'node/'. $element->nid,
        array(
            'absolute' => TRUE,
            'query' => array(
                'mediathequePath' => current_path()
            )
        )
    );

    print '<div class="result-row">';

            if ($element->publicElement):
                if (!is_null($element->field_media_cpu_nid) ):
                    if (!isset($_SESSION['CPU_accepted']) || !in_array($element->nid, $_SESSION['CPU_accepted']['nid'])):
                        $CPUBody = $element->body_value;
                        print '<div class="bodyCPU" style="display:none;">';
                            print $CPUBody;
                        print '</div>';
                        print '<a href="'. $urlToMedia .'" class="media-cpu" data-nid="'.$element->nid.'">';
                    else:
                        print '<a href="'. $urlToMedia .'" data-nid="'.$element->nid.'">';
                    endif;
                else:
                    print '<a href="'. $urlToMedia .'" data-nid="'.$element->nid.'">';
                endif;
            else:
                    print '<a href="'. $urlToMedia .'" class="'.$publicElementClass.'" data-nid="'.$element->nid.'" data-roleAllowed="$role_allowed à faire" data-userlogged="'.($user->uid !== 0 ? 'true' : 'false').'">';
            endif;
            
            print '<div class="' . $publicElementClass . '">';
/*
            if (!is_null($element->asset_field_data_field_media_doc_type) || !is_null($element->uri) || !is_null($element->field_asset_module_video_file_snapshot)) :
                print '<div class="media-asset">';

                    print '<div class="asset-img">';

                        if($element->asset_field_data_field_media_doc_type == 'document' || $element->asset_field_data_field_media_doc_type == 'document_pdf') :
                            
                            $asset_img_doc_path = drupal_get_path('module', 'ecofolio_display_mediatheque') . '/images/default_doc.png';
                            
                            $asset_img_doc = array(
                              'style_name' => 'listing_mediatheque',
                              'path'       => $asset_img_doc_path,
                              'width'      => '82px',
                              'height'     => '82px',
                              'alt'        => '',
                              'title'      => '',
                            );

                            print theme('image',$asset_img_doc);                        

                        elseif (!is_null($element->uri)) :
                            $asset_img_url = file_create_url($element->uri);
                            
                            $asset_img = array(
                              'style_name' => 'listing_mediatheque',
                              'path'       => $asset_img_url,
                              'width'      => '82px',
                              'height'     => '82px',
                              'alt'        => '',
                              'title'      => '',
                            );

                            print theme('image',$asset_img);

                        elseif(!is_null($element->field_asset_module_video_file_snapshot)) :
                            $asset_video_url = file_create_url($element->field_asset_module_video_file_snapshot);
                            
                            $asset_video = array(
                              'style_name' => 'listing_mediatheque',
                              'path'       => $asset_video_url,
                              'width'      => '82px',
                              'height'     => '82px',
                              'alt'        => '',
                              'title'      => '',
                            );

                            print theme('image',$asset_video);
                        endif;

                    print '</div>';

                    if($element->asset_field_data_field_media_doc_type == 'document' || $element->asset_field_data_field_media_doc_type == 'document_pdf') :
                        if ($element->asset_field_data_field_media_doc_type == 'document') :
                            print '<div class="asset-type">';
                                print $element->asset_field_data_field_media_doc_type;
                            print '</div>';
                        //endif;

                        elseif ($element->asset_field_data_field_media_doc_type == 'document_pdf') :
                            print '<div class="asset-type">';
                                print t('PDF');
                            print '</div>';
                        endif;

                    elseif ($element->type == 'image') :
                        print '<div class="asset-type">';
                            print $element->type;
                        print '</div>';

                    elseif(!is_null($element->field_asset_module_video_file_snapshot)) :
                        print '<div class="asset-type">';
                            print $element->asset_field_data_field_media_video_type;
                        print '</div>';
                    endif;
                                 

                print '</div>';

            endif;*/
            
            print '<div class="type-perm-result">';
                print '<div class="type-result">';
                    if($element->asset_field_data_field_media_doc_type=='document') print 'document';
                    elseif($element->asset_field_data_field_media_doc_type=='document_pdf') print 'pdf';
                    elseif ($element->type == 'image') print 'photo';
                    elseif(!is_null($element->field_asset_module_video_file_snapshot)) print 'vidéo';
                print '</div>';
            print '</div>';

            print '<div class="date-perm-result">';

                print '<div class="date-result">';
                    print $element->dateFr;
                print '</div>';


            print '</div>';
            
            print '<div class="title-teaser-result">';

                print '<div class="title-result">';
                    print '<p>'.$element->title.'</p>';
                    if(isset($element->field_media_essentials_value)) print '<span class="essentials"></span>';
                print '</div>';

                print '<div class="teaser-result">';
                    print '<p>'.$element->field_media_teaser_value.'</p>';
                print '</div>';

            print '</div>';


            print '<div class="clearfix"></div>';

        print '</div>';

        
        print '</a>';

    print '</div>';
                